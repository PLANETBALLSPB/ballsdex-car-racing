<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BallsDex Car Racing</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- CSS -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <h1>ğŸ BallsDex Car Racing</h1>
  <p class="subtitle">SimulaciÃ³n visual de carrera</p>

  <div id="track">
    <div class="lane-label">Jugador 1</div>
    <div class="lane-label second">Jugador 2</div>
  </div>

  <div id="info">
    <p id="status">Preparando carrera...</p>
  </div>

  <!-- JS -->
  <script>
    fetch("race.json")
      .then(response => response.json())
      .then(data => startRace(data))
      .catch(() => {
        document.getElementById("status").textContent =
          "âŒ No se pudo cargar race.json";
      });

    function startRace(data) {
      const track = document.getElementById("track");
      const status = document.getElementById("status");

      const car1 = document.createElement("div");
      car1.className = "car car1";
      car1.textContent = data.player1.name;

      const car2 = document.createElement("div");
      car2.className = "car car2";
      car2.textContent = data.player2.name;

      track.appendChild(car1);
      track.appendChild(car2);

      let pos1 = 0;
      let pos2 = 0;
      let lap = 1;
      const maxLaps = 3;
      const finishLine = 620;

      status.textContent = "ğŸš¦ Â¡Salida!";

      const interval = setInterval(() => {
        pos1 += data.player1.speed;
        pos2 += data.player2.speed;

        car1.style.left = pos1 + "px";
        car2.style.left = pos2 + "px";

        if (pos1 >= finishLine || pos2 >= finishLine) {
          lap++;
          pos1 = 0;
          pos2 = 0;

          if (lap > maxLaps) {
            clearInterval(interval);

            const winner =
              data.player1.speed > data.player2.speed
                ? data.player1.name
                : data.player2.name;

            status.textContent = "ğŸ† Ganador: " + winner;
          } else {
            status.textContent = "ğŸ” Vuelta " + lap + " / " + maxLaps;
          }
        }
      }, 60);
    }
  </script>

</body>
</html>
